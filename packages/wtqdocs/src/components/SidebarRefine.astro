---
import { getCollection } from "astro:content";
import Category from "./Category.astro";
import CollapseButton from "./CollapseButton.astro";
import type { WathqnyConfig as WathqnyConfigType } from "wtqtypes";

// @ts-ignore
import untypedWathqnyConfig from "/wathqny.config";

const WathqnyConfig: WathqnyConfigType = untypedWathqnyConfig;

const docs = await getCollection("docs");

const { sidebar } = WathqnyConfig;

docs.sort(
  (a: { data: { position: number } }, b: { data: { position: number } }) =>
    a.data.position > b.data.position ? 1 : -1
);

let currentUrl =
  "/" +
  Astro.url.pathname
    .split("/")
    .filter((url) => url !== "")
    .reverse()[0];

let ActiveClass: boolean = true;
---

<aside class="wtq-sidebar">
  <ul class="sidebar_category" role="tablist">
    {
      sidebar?.map((item) => {
        return (
          <li role="tab">
            <Category name={item}>
              <Category name={item} href={item} />
            </Category>
          </li>
        );
      })
    }
  </ul>
  <CollapseButton />
</aside>

<script src="./sidebar.ts"></script>
